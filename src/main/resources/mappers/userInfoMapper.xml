<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="userinfo">

	<insert id="insert" parameterType="userinfo">
		insert All
			into userinfos values(#{id},#{password}, #{name},#{nickname},#{birth},#{email},#{addr},#{tel},#{profile},#{secure},#{secure_ans},
			sysdate, sysdate,#{auth})
			into USERSTATE (SNO,ID) values (USERSTATE_SEQ.NEXTVAL,#{id})
			SELECT * FROM DUAL
	</insert>

	
	<select id="dupCheck" resultType="String">
		select id from userinfos where id = #{id}
	</select>
	
	<select id="login" resultType="String">
		select password from userinfos where id = #{id}
	</select>
	
	<select id="readId" resultType="String">
		select id from userinfos where name=#{name} and birth= #{birth}
	</select>
	
	<select id="passChange" resultType="userinfo">
		select secure, secure_ans from userinfos where id = #{id} and name = #{name}
	</select>
	
	<update id="updatePassword">
		update userinfos set password = #{password} where id = #{id}
	</update>
	
	<select id="nickCheck" resultType="string">
		select nickname from userinfos where nickname = #{nickname}
	</select>
	
	<select id="selectprofile" resultType="String">
		select profile from userinfos where id=#{id}
	</select>
	
	<select id="selectMyAuth" resultType="int">
		select auth from userinfos where id = #{id}
	</select>
	
	<select id="selectMyNick" resultType="string">
		select nickname from userinfos where id = #{id}
	</select>
	
	<update id="updateProfilePicture">
		update userinfos set profile = #{profile} where id = #{id}
	</update>
	
	<select id="isYoublacklist" resultType="java.util.HashMap">
		select STATE, PENALTY_CNT from userstate inner join USERINFOS on USERINFOS.ID=userstate.ID WHERE USERINFOS.ID = #{id}
	</select>
	
	<select id="selectAddr" resultType="string">
		select addr from userinfos where id = #{id}
	</select>
</mapper>
